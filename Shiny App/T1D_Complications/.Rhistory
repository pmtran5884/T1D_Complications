shiny::runApp()
runApp()
runApp()
runApp()
runApp()
DPN_mod<-readRDS("data/T1Dcomp_DPNmod_logit.rds")
DPN_mod
predict(DPN_mod,newdata = c(HTN3="Yes",))
predict(DPN_mod,newdata = c(HTN3="Yes"))
predict(DPN_mod,newdata = c(Dyslipidemia3="Yes"))
predict(DPN_mod,newdata = c("Yes","Yes",50,30,120,7))
predict(DPN_mod,newdata = c("Yes","Yes",50,30,120,7),na.action = na.pass)
predict(DPN_mod,newdata = c("Yes","Yes",50,30,120,7),na.action = na.pass,type = "prob")
summary(DPN_mod)
predict(DPN_mod,newdata = c(HTN3Yes="Yes","Yes",50,30,120,7),na.action = na.pass,type = "prob")
predict(DPN_mod,newdata = data.frame(HTN3Yes="Yes","Yes",50,30,120,7),na.action = na.pass,type = "prob")
predict(DPN_mod,newdata = data.frame(HTN3="Yes","Yes",50,30,120,7),na.action = na.pass,type = "prob")
runApp()
predict(DPN_mod,
newdata=c(Dr_Age=input$Age,
Dur=input$T1D_dur,
AvgA1c=input$HbA1C,
avg.Systolic=input$SBP,
Dyslipidemia3=input$Dyslipidemia,
HTN3=input$Hypertension),
type = "prob")
predict(DPN_mod,newdata = data.frame(HTN3="Yes","Yes",50,30,120,7),na.action = na.pass,type = "prob")
predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",50,30,120,7),na.action = na.pass,type = "prob")
predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")
predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2]
round(predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4)
runApp()
round(predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4)
runApp()
round(predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4)
as.vector(round(predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4))
paste("check",round(predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4))
paste("check",round(predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4),"%")
paste("check",round(predict(DPN_mod,newdata = c(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4),"%")
paste("check",round(predict(DPN_mod,newdata = c(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4),"%")
paste("check",round(predict(DPN_mod,newdata = mat(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4),"%")
paste("check",round(predict(DPN_mod,newdata = as.data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4),"%")
runApp()
paste("check",round(predict(DPN_mod,newdata = data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7),na.action = na.pass,type = "prob")[2],4),"%")
data.frame(HTN3="Yes",Dyslipidemia3="Yes",Dr_Age=50,Dur=30,avg.Systolic=120,AvgA1c=7)
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
library(caret)
DPN_mod<-readRDS("data/T1Dcomp_DPNmod_logit.rds")
DAN_mod<-readRDS("data/T1Dcomp_DANmod_logit.rds")
DRET_mod<-readRDS("data/T1Dcomp_DRETmod_logit.rds")
DNEP_mod<-readRDS("data/T1Dcomp_DNEPmod_logit.rds")
predict(DPN_mod,
newdata=data.frame(Dr_Age=40,
Dur=10,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "prob")
predict(DPN_mod,
newdata=data.frame(Dr_Age=40,
Dur=10,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "response")
predict(DPN_mod,
newdata=data.frame(Dr_Age=40,
Dur=10,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "prob")
predict(DAN_mod,
newdata=data.frame(Dr_Age=40,
Dur=10,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "prob")
DPN_mod
predict(DPN_mod$call,
newdata=data.frame(Dr_Age=40,
Dur=10,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "prob")
rm(list=ls(all=TRUE))
library(caret)
library(doParallel)
library(dplyr)
library(pROC)
library(glmnet)
source("my_functions.R")
T1Dcomp_alldata<-read.csv("2_T1DComplications data_cleaned for Paul.csv")
set.seed(123)
# 1) DPN
dpn <- compare_3_models(T1Dcomp_alldata,"Peripheral_Neuropathy3",varstoassess = c("Peripheral_Neuropathy3","Autonomic_Neuropathy3","DM_Retinopathy3","DM_Nephropathy3","HTN3","Dyslipidemia3","CAD3","Prior_TIA3","Prior_MI3","Prior_CVA3","Dr_Age","Dur","Hemoglobin","Albumin","avg.Creatinine","avg.Systolic","avg.BUN","avg.MicroAlb","AvgA1c","Sex","HDL","Max_HbA1c"))
# 1) DPN
dpn <- compare_3_models(T1Dcomp_alldata,"Peripheral_Neuropathy3",varstoassess = c("Peripheral_Neuropathy3","Autonomic_Neuropathy3","DM_Retinopathy3","DM_Nephropathy3","HTN3","Dyslipidemia3","CAD3","Prior_TIA3","Prior_MI3","Prior_CVA3","Dr_Age","Dur","Hemoglobin","Albumin","avg.Creatinine","avg.Systolic","avg.BUN","avg.MicroAlb","AvgA1c","Sex","HDL","Max_HbA1c"))
# 2) DAN
can <- compare_3_models(T1Dcomp_alldata,"Autonomic_Neuropathy3",varstoassess = c("Autonomic_Neuropathy3","Peripheral_Neuropathy3","DM_Retinopathy3","DM_Nephropathy3","HTN3","Dyslipidemia3","CAD3","Prior_TIA3","Prior_MI3","Prior_CVA3","Dr_Age","Dur","Hemoglobin","Albumin","avg.Creatinine","avg.Systolic","avg.BUN","avg.MicroAlb","AvgA1c","Sex","HDL","Max_HbA1c"))
# 3) Dret
dr <- compare_3_models(T1Dcomp_alldata,"DM_Retinopathy3",varstoassess = c("DM_Retinopathy3","Peripheral_Neuropathy3","Autonomic_Neuropathy3","DM_Nephropathy3","HTN3","Dyslipidemia3","CAD3","Prior_TIA3","Prior_MI3","Prior_CVA3","Dr_Age","Dur","Hemoglobin","Albumin","avg.Creatinine","avg.Systolic","avg.BUN","avg.MicroAlb","AvgA1c","Sex","HDL","Max_HbA1c"))
# 4) Dnep
dn <- compare_3_models(T1Dcomp_alldata,"DM_Nephropathy3",varstoassess = c("DM_Nephropathy3","Peripheral_Neuropathy3","Autonomic_Neuropathy3","DM_Retinopathy3","HTN3","Dyslipidemia3","CAD3","Prior_TIA3","Prior_MI3","Prior_CVA3","Dr_Age","Dur","Hemoglobin","Albumin","avg.Creatinine","avg.Systolic","avg.BUN","avg.MicroAlb","AvgA1c","Sex","HDL","Max_HbA1c"))
#nomogram
library(rms)
T1Dcomp_alldata<-read.csv("2_T1DComplications data_cleaned for Paul.csv")
options(datadist='ddist')
ddist <-datadist(T1Dcomp_alldata)
# 1) dpn
dpn.mod<-lrm(Peripheral_Neuropathy3~Dr_Age+Dur+avg.Systolic+AvgA1c,data=T1Dcomp_alldata)
nom.dpn<-nomogram(dpn.mod,
lp.at = seq(-3,4,by=0.5),
fun = function(x)1/(1+exp(-x)),
fun.at=c(0.001,0.01,.05,seq(0.1,0.9,by=0.1),0.95,0.99,0.999),
funlabel="Risk of Death",
conf.int=c(0.1,0.7),
abbrev=T,
minlength=1,lp=F)
# 2) dan
dan.mod<-lrm(Autonomic_Neuropathy3~Dr_Age+Dur+avg.Systolic+AvgA1c,data=T1Dcomp_alldata)
nom.dan<-nomogram(dan.mod,
lp.at = seq(-3,4,by=0.5),
fun = function(x)1/(1+exp(-x)),
fun.at=c(0.001,0.01,.05,seq(0.1,0.9,by=0.1),0.95,0.99,0.999),
funlabel="Risk of Complication",
conf.int=c(0.1,0.7),
abbrev=T,
minlength=1,lp=F)
# 3) dret
dret.mod<-lrm(DM_Retinopathy3~Dr_Age+Dur+avg.Systolic+AvgA1c,data=T1Dcomp_alldata)
nom.dret<-nomogram(dret.mod,
lp.at = seq(-3,4,by=0.5),
fun = function(x)1/(1+exp(-x)),
fun.at=c(0.001,0.01,.05,seq(0.1,0.9,by=0.1),0.95,0.99,0.999),
funlabel="Risk of Complication",
conf.int=c(0.1,0.7),
abbrev=T,
minlength=1,lp=F)
# 4) dnep
dnep.mod<-lrm(DM_Nephropathy3~Dr_Age+Dur+avg.Systolic+AvgA1c,data=T1Dcomp_alldata)
nom.dnep<-nomogram(dnep.mod,
lp.at = seq(-3,4,by=0.5),
fun = function(x)1/(1+exp(-x)),
fun.at=c(0.001,0.01,.05,seq(0.1,0.9,by=0.1),0.95,0.99,0.999),
funlabel="Risk of Complication",
conf.int=c(0.1,0.7),
abbrev=T,
minlength=1,lp=F)
#save data
saveRDS(dpn.mod,file = "/Users/paultran/Box/Students/T1D_complications/Shiny App/T1D_Complications/data/T1Dcomp_DPNmod_logit.rds")
saveRDS(dan.mod,file = "/Users/paultran/Box/Students/T1D_complications/Shiny App/T1D_Complications/data/T1Dcomp_DANmod_logit.rds")
saveRDS(dret.mod,file = "/Users/paultran/Box/Students/T1D_complications/Shiny App/T1D_Complications/data/T1Dcomp_DRETmod_logit.rds")
saveRDS(dnep.mod,file = "/Users/paultran/Box/Students/T1D_complications/Shiny App/T1D_Complications/data/T1Dcomp_DNEPmod_logit.rds")
#summary and plot
summary(dpn.mod);summary(dan.mod);summary(dret.mod);summary(dnep.mod);plot(nom.dpn);plot(nom.dan);plot(nom.dret);plot(nom.dnep)
predict(dpn.mod,
newdata=data.frame(Dr_Age=40,
Dur=10,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "prob")
predict(dpn.mod,
newdata=data.frame(Dr_Age=40,
Dur=10,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "fitted")
predict(dpn.mod,
newdata=data.frame(Dr_Age=40,
Dur=40,
AvgA1c=6,
avg.Systolic=130),
na.action = na.pass,
type = "fitted")
predict(dpn.mod,
newdata=data.frame(Dr_Age=40,
Dur=40,
AvgA1c=10,
avg.Systolic=130),
na.action = na.pass,
type = "fitted")
predict(dpn.mod,
newdata=data.frame(Dr_Age=40,
Dur=40,
AvgA1c=10,
avg.Systolic=150),
na.action = na.pass,
type = "fitted")
predict(dpn.mod,
newdata=data.frame(Dr_Age=60,
Dur=40,
AvgA1c=10,
avg.Systolic=150),
na.action = na.pass,
type = "fitted")
runApp()
shiny::runApp()
runApp()
runApp()
runApp()
runApp()
shiny::runApp()
runApp()
runApp()
shiny::runApp()
shiny::runApp()
shiny::runApp()
runApp()
shiny::runApp()
